<%@ template version="1.0" language = "groovy" %>
SELECT S.SCHEMANAME, T.TABLENAME, C.COLUMNNAME, SUM(1) FACT
FROM SYS.SYSSCHEMAS S 
JOIN SYS.SYSTABLES T ON T.SCHEMAID = S.SCHEMAID
JOIN SYS.SYSCOLUMNS C ON C.REFERENCEID = T.TABLEID
WHERE S.SCHEMANAME = 'SYS'
GROUP BY ROLLUP( S.SCHEMANAME, T.TABLENAME, C.COLUMNNAME )
ORDER BY S.SCHEMANAME, T.TABLENAME, C.COLUMNNAME
